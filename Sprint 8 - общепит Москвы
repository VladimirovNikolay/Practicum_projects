#!/usr/bin/env python
# coding: utf-8

# # –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ú–æ—Å–∫–≤—ã
# 
# - –ê–≤—Ç–æ—Ä: –í–ª–∞–¥–∏–º–∏—Ä–æ–≤ –ù–∏–∫–æ–ª–∞–π –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á
# - –î–∞—Ç–∞: 29.10.2025

# ### –¶–µ–ª–∏ –∏ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞
# 
# –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ú–æ—Å–∫–≤—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç—ã –∏ –Ø–Ω–¥–µ–∫—Å –ë–∏–∑–Ω–µ—Å –Ω–∞ –ª–µ—Ç–æ 2022 –≥–æ–¥–∞.
# –ù–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω–≤–µ—Å—Ç–æ—Ä—ã –∏–∑ —Ñ–æ–Ω–¥–∞ Shut Up and Take My Money –ø—Ä–∏–º—É—Ç —Ä–µ—à–µ–Ω–∏–µ –æ–± –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –≤ –ú–æ—Å–∫–≤–µ: : –∫–∞—Ñ–µ, —Ä–µ—Å—Ç–æ—Ä–∞–Ω –∏–ª–∏ –±–∞—Ä.

# ### –û–ø–∏—Å–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
# 
# –§–∞–π–ª `/datasets/rest_info.csv` —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è:
# - `name` ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è;
# - `address` ‚Äî –∞–¥—Ä–µ—Å –∑–∞–≤–µ–¥–µ–Ω–∏—è;
# - `district` ‚Äî –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞–π–æ–Ω, –≤ –∫–æ—Ç–æ—Ä–æ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞–≤–µ–¥–µ–Ω–∏–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥;
# - `category` ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∑–∞–≤–µ–¥–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä ¬´–∫–∞—Ñ–µ¬ª, ¬´–ø–∏—Ü—Ü–µ—Ä–∏—è¬ª –∏–ª–∏ ¬´–∫–æ—Ñ–µ–π–Ω—è¬ª;
# - `hours` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–Ω—è—Ö –∏ —á–∞—Å–∞—Ö —Ä–∞–±–æ—Ç—ã;
# - `rating` ‚Äî —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø–æ –æ—Ü–µ–Ω–∫–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –Ø–Ω–¥–µ–∫—Å –ö–∞—Ä—Ç–∞—Ö (–≤—ã—Å—à–∞—è –æ—Ü–µ–Ω–∫–∞ ‚Äî 5.0);
# - `chain` ‚Äî —á–∏—Å–ª–æ, –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ–µ 0 –∏–ª–∏ 1, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã–º 
#     0 ‚Äî –∑–∞–≤–µ–¥–µ–Ω–∏–µ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ç–µ–≤—ã–º;
#     1 ‚Äî –∑–∞–≤–µ–¥–µ–Ω–∏–µ —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ç–µ–≤—ã–º.
# - `seats` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç.
# 
# –§–∞–π–ª `/datasets/rest_price.csv` —Å–æ–¥–µ—Ä–∂–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ä–µ–¥–Ω–µ–º —á–µ–∫–µ –≤ –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è:
# - `price` ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Ü–µ–Ω –≤ –∑–∞–≤–µ–¥–µ–Ω–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä ¬´—Å—Ä–µ–¥–Ω–∏–µ¬ª, ¬´–Ω–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ¬ª, ¬´–≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ¬ª –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ;
# - `avg_bill `‚Äî —Ö—Ä–∞–Ω–∏—Ç —Å—Ä–µ–¥–Ω—é—é —Å—Ç–æ–∏–º–æ—Å—Ç—å –∑–∞–∫–∞–∑–∞ –≤ –≤–∏–¥–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
# - `middle_avg_bil`l ‚Äî —á–∏—Å–ª–æ —Å –æ—Ü–µ–Ω–∫–æ–π —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞
# - `middle_coffee_cup` ‚Äî —á–∏—Å–ª–æ —Å –æ—Ü–µ–Ω–∫–æ–π –æ–¥–Ω–æ–π —á–∞—à–∫–∏ –∫–∞–ø—É—á–∏–Ω–æ

# ### –°–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø—Ä–æ–µ–∫—Ç–∞
# 
# <font color='#777778'>- [1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –Ω–∏–º–∏](#1.-–ó–∞–≥—Ä—É–∑–∫–∞-–¥–∞–Ω–Ω—ã—Ö-–∏-–∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ-—Å-–Ω–∏–º–∏)
#   - [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –µ–¥–∏–Ω–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞](#–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–µ–¥–∏–Ω–æ–≥–æ-–¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞)
# - [2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö](#2.-–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞-–¥–∞–Ω–Ω—ã—Ö)
#   - [–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥](#–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π-–≤—ã–≤–æ–¥)
# - [3. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö](#3.-–ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π-–∞–Ω–∞–ª–∏–∑-–¥–∞–Ω–Ω—ã—Ö)
#   - [–ó–∞–¥–∞—á–∞ 1. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π](#–ó–∞–¥–∞—á–∞-1)
#   - [–ó–∞–¥–∞—á–∞ 2. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º –æ–∫—Ä—É–≥–∞–º](#–ó–∞–¥–∞—á–∞-2)
#   - [–ó–∞–¥–∞—á–∞ 3. –°–µ—Ç–µ–≤—ã–µ –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è](#–ó–∞–¥–∞—á–∞-3)
#   - [–ó–∞–¥–∞—á–∞ 4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç](#–ó–∞–¥–∞—á–∞-4)
#   - [–ó–∞–¥–∞—á–∞ 5. –†–µ–π—Ç–∏–Ω–≥ –∑–∞–≤–µ–¥–µ–Ω–∏–π](#–ó–∞–¥–∞—á–∞-5)
#   - [–ó–∞–¥–∞—á–∞ 6. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞](#–ó–∞–¥–∞—á–∞-6)
#   - [–ó–∞–¥–∞—á–∞ 7. –¢–æ–ø-15 ](#–ó–∞–¥–∞—á–∞-7)
#   - [–ó–∞–¥–∞—á–∞ 8. –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ —Ä–∞–π–æ–Ω–∞–º](#–ó–∞–¥–∞—á–∞-8)
#   - [–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥](#–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π-–≤—ã–≤–æ–¥)
# - [4. –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#4.-–ò—Ç–æ–≥–æ–≤—ã–π-–≤—ã–≤–æ–¥-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)</font>
# 
# ---

# ## 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –Ω–∏–º–∏
# 

# In[1]:


import pandas as pd


# In[2]:


get_ipython().system('pip install phik')


# In[3]:


import phik
from phik import phik_matrix


# In[4]:


df_inf = pd.read_csv('/datasets/rest_info.csv')


# In[5]:


df_pr = pd.read_csv('/datasets/rest_price.csv')


# In[6]:


display(df_inf.info())


# In[7]:


display(df_inf.head())


# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö `rest_info.csv` –∏–º–µ–µ—Ç 9 —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ 8406 —Å—Ç—Ä–æ–∫. –ü—Ä–æ–ø—É—Å–∫–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤ —Å—Ç–æ–ª–±—Ü–∞—Ö `hours` –∏ `seats`. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã –≤–µ—Ä–Ω–æ, –Ω–æ —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å `chain` –º–æ–∂–Ω–æ –ø–æ–º–µ–Ω—è—Ç—å.     
# 

# In[8]:


display(df_pr.info())


# In[9]:


display(df_pr.head())


# –í –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ `rest_price.csv` 5 —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ 4058 —Å—Ç—Ä–æ—á–µ–∫. –ü—Ä–æ–ø—É—Å–∫–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –≤–æ –≤—Å–µ—Ö —Å—Ç–æ–ª–±—Ü–∞—Ö, –∫—Ä–æ–º–µ id.

# ### –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –µ–¥–∏–Ω–æ–≥–æ –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–∞
# 

# In[10]:


df = pd.merge(df_inf, df_pr, how='left', on='id')


# In[11]:


df.info()


# In[12]:


print("–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ —Ç–∞–±–ª–∏—Ü:",round((len(df_inf)-len(df))/len(df_inf)*100,2), "%")


# –í –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–º –¥–∞—Ç–∞—Ñ—Ä–µ–π–º–µ 13 –∫–æ–ª–æ–Ω–æ–∫ –∏ 8406 —Å—Ç—Ä–æ—á–µ–∫.

# In[13]:



temp = df.copy() 
len(temp)


# ## 2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
# 

# In[14]:


df['chain'] = pd.to_numeric(df['chain'], downcast='integer')
df['seats'] = pd.to_numeric(df['seats'], downcast='integer')


# In[15]:


for column in ['rating','middle_avg_bill','middle_coffee_cup']:
    df[column] = pd.to_numeric(df[column], downcast='float')


# In[16]:


display(df.info())


# In[17]:


print(df.isna().sum())


# In[18]:


round(df.isna().sum() / df.shape[0]*100, 2)


# - –ü—Ä–æ–ø—É—Å–∫ –≤ —Å—Ç–æ–ª–±—Ü–µ `hours` —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 6,38% –∏–ª–∏ 536.
# - –í —Å—Ç–æ–ª–±—Ü–µ `seats` 42.96% –∏–ª–∏ 3611 - –Ω–µ –≤—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π –∏–º–µ—é—Ç –ø–æ—Å–∞–¥–æ—á–Ω—ã–µ –º–µ—Å—Ç–∞, –∑–∞–º–µ–Ω–∏–º –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–∞ -1.  
# - –í `price` 60.56% –∏–ª–∏ 5091 
# - –í `avg_bil`l 54.60% –∏–ª–∏ 4590, –µ—Å—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏—è, –≥–¥–µ –Ω–µ —É–∫–∞–∑–∞–Ω—ã —Ü–µ–Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
# - –í `middle_avg_bill` 62.54% –∏–ª–∏ 5257 –∑–∞–≤–∏—Å–∏—Ç –æ—Ç `avg_bill` –∏ –ø—Ä–æ–ø—É—Å–∫–∏ —Ç–æ–∂–µ. 
# - –í `middle_coffee_cup` 93.64% –∏–ª–∏ 7871 –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —Ü–µ–Ω—ã —É–∫–∞–∑–∞–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–≤–µ–¥–µ–Ω–π –≥–¥–µ –ø—Ä–æ–¥–∞—é—Ç –∫–æ—Ñ–µ. –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å—Ç–æ–ª–±—Ü–∞ `avg_bill`. 
# 
# –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –≤ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–ø—É—Å–∫–∞–º –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö. `price`, `avg_bil`, `middle_avg_bill`, `middle_coffee_cup` - –æ—Ç—Å–∞–≤–ª—é –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

# In[19]:


df['hours'] = df['hours'].fillna('–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã')


# In[20]:


# –ü—Ä–æ–≤–µ—Ä–∏–º —Å–∫–æ–ª—å–∫–æ —É–¥–∞–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫ –¥–∞—Ç–∞—Å–µ—Ç–∞
a, b = len(temp), len(df)
print(a, b, round((a-b)/a*100, 2))


# In[21]:


df['seats'] = df['seats'].fillna(-1).astype(int)


# In[22]:


display(df['category'].unique())


# In[23]:


df.info()


# In[24]:


df.duplicated().sum()


# –ü–æ–ª–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.

# In[25]:


#–ø–µ—Ä–µ–≤–æ–∂—É –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä
df['address'] = df['address'].str.lower().str.strip()
df['name'] = df['name'].str.lower().str.strip()


# In[26]:


#–ø–æ–¥—Å—á–µ—Ç –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –≤ address
sum_duplicates = df.duplicated(subset=['address', 'name'], keep='first').sum()
print(sum_duplicates)


# In[27]:


df = df.drop_duplicates(subset=['address', 'name'], keep='first')


# In[28]:


df.info()


# In[29]:


df['is_24_7'] = (df['hours'] == '–µ–∂–µ–¥–Ω–µ–≤–Ω–æ, –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ')
print(df['is_24_7'].sum())


# In[30]:


sum_duplicates_id = df.duplicated(subset='id', keep='first').sum()
print(sum_duplicates_id)


# In[31]:


# –ü—Ä–æ–≤–µ—Ä–∏–º —Å–∫–æ–ª—å–∫–æ —É–¥–∞–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫ –¥–∞—Ç–∞—Å–µ—Ç–∞
a, b = len(temp), len(df)
print(" –ë—ã–ª–æ —Å—Ç—Ä–æ–∫ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ", a,
      '\n', "–û—Å—Ç–∞–ª–æ—Å—å —Å—Ç—Ä–æ–∫ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏", b,
      '\n', "–£–¥–∞–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫ –≤ –¥–∞—Ç–∞—Å–µ—Ç–µ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏", a-b,
      '\n', "–ü—Ä–æ—Ü–µ–Ω—Ç –ø–æ—Ç–µ—Ä—å", round((a-b)/a*100, 2))


# ---
# 
# ### –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥
# 

# –û–±—ä–µ–¥–∏–Ω–∏–ª —Ç–∞–±–ª–∏—Ü—ã /rest_info.csv –∏ /rest_price.csv —Å –ø–æ–º–æ—â—å—é merge(left).

# –ó–∞–º–µ–Ω–∏–ª –ø—Ä–æ–ø—É—Å–∫–∏ –≤ `hours` - 536 –ø—Ä–æ–ø—É—Å–∫–æ–≤ –Ω–∞ –∑–∞–≥–ª—É—à–∫–∏: '–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã'.

# –ò–∑–º–µ–Ω–∏–ª —Ä–∞–∑—Ä—è–¥–Ω–æ—Å—Ç—å —É —Å—Ç–æ–ª–±—Ü–æ–≤ - `rating`, `middle_avg_bill`, `middle_coffee_cup` c float64 –Ω–∞ float32. –£ `chain` –Ω–∞ int8.
# –£ `seats` –Ω–∞ int16.

# –í `seats` –µ—Å—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏—è –≥–¥–µ –Ω–µ—Ç –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ - 3611 –∑–∞–≤–µ–¥–µ–Ω–∏–π, –∑–∞–º–µ–Ω–∏–ª –ø—Ä–æ–ø—É—Å–∫–∏ –Ω–∞ -1. 
# 
# –Ø–≤–Ω—ã—Ö –ø–æ–ª–Ω—ã—Ö –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.

# –ü–µ—Ä–µ–≤–µ–ª `address` –∏ `name` –≤ –Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä –∏ –ø–æ —ç—Ç–∏–º –¥–≤—É–º —Å—Ç–æ–ª–±—Ü–∞–º –∏—Å–∫–∞–ª –¥—É–±–ª–∏–∫–∞—Ç—ã. –ù–∞–π–¥–µ–Ω–æ 4 –¥—É–±–ª–∏–∫–∞—Ç–∞. –£–¥–∞–ª–∏–ª. –ü–æ—Ç–µ—Ä—è —Å–æ—Å—Ç–∞–≤–∏–ª–∞ –≤—Å–µ–≥–æ 0.05%
# 
# –°–æ–∑–¥–∞–ª —Å–æ–ª–±–µ—Ü —Å —Ä–µ–∂–∏–º–æ–º —Ä–∞–±–æ—Ç—ã - `is_24_7`(–∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω–æ), —Ç–∞–∫–∏—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–∫–∞–∑–∞–ª–æ—Å—å 730.

# ## 3. –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
# 

# ---
# 
# ### –ó–∞–¥–∞—á–∞ 1
# 

# In[32]:


category_sum = df['category'].value_counts()


# In[33]:


display(category_sum)


# In[34]:


category_sum_pr = df['category'].value_counts(normalize=True)
display(round(category_sum_pr, 2)*100)


# In[35]:


import matplotlib.pyplot as plt
import seaborn as sns


# In[36]:


category_sort = category_sum.sort_values(ascending=True)


# In[37]:


graf = category_sort.plot(kind='barh', figsize=(12, 6), color='skyblue', edgecolor='black')
plt.grid(axis='x', alpha=0.7)
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º')
plt.xlabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏–∏')
plt.show()


# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞—Ñ–µ –ª–∏–¥–∏—Ä—É–µ—Ç - 2002 –∏–ª–∏ 28%. –†–µ—Å—Ç–æ—Ä–∞–Ω—ã –Ω–∞ –≤—Ç–æ—Ä–æ–º –º–µ—Å—Ç–µ - 1968 –∏–ª–∏ 24%. –ö–∞—Ñ–µ–π–Ω–∏ - 1398 –∏–ª–∏ 17%. –û—á–µ–Ω—å –º–∞–ª–æ –±—É–ª–æ—á–Ω—ã—Ö –≤—Å–µ–≥–æ 249 –∏–ª–∏ 3%. –¢–∞–∫ –∂–µ —Å—Ç–æ–ª–æ–≤—ã—Ö –Ω–µ–º–Ω–æ–≥–æ –ø–æ–±–æ–ª—å—à–µ —á–µ–º –±—É–ª–æ—á–Ω—ã—Ö, –Ω–æ–≥ —Ç–æ–∂–µ –º–∞–ª–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π - 315 –∏–ª–∏ 4%.

# ---
# 
# ### –ó–∞–¥–∞—á–∞ 2
# 
# –ö–∞–∫–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ —Ä–∞–π–æ–Ω—ã –ú–æ—Å–∫–≤—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ –¥–∞–Ω–Ω—ã—Ö? –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–º —Ä–∞–π–æ–Ω–∞–º –ú–æ—Å–∫–≤—ã, –∞ —Ç–∞–∫–∂–µ –æ—Ç–¥–µ–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏–π –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ –ú–æ—Å–∫–≤—ã. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è–º–∏.

# In[38]:


district_count = df['district'].value_counts()
display(district_count)


# In[39]:


district_count_pr = df['district'].value_counts(normalize=True)
display(round((district_count_pr*100), 2))


# In[40]:


district_sort = district_count.sort_values(ascending=True)


# In[41]:


graf_1 = district_sort.plot(kind='barh', figsize=(12, 6), color='skyblue', edgecolor='black')
plt.grid(axis='x', alpha=0.7)
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–∞–¥–µ–Ω–∏–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –ø–æ –æ–∫—Ä—É–≥–∞–º')
plt.xlabel('–ù–∞–∑–≤–∞–Ω–∏—è –æ–∫—Ä—É–≥–æ–≤')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.show()


# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ 2211 –∏–ª–∏ 28%. –ü–æ 10% –∑–∞–≤–µ–¥–µ–Ω–∏–π —É –°–µ–≤–µ—Ä–Ω–æ–≥–æ, –°–µ–≤–µ—Ä–æ-–í–æ—Å—Ç–æ—á–Ω–æ–≥–æ –∏ –Æ–∂–Ω–æ–≥–æ –æ–∫—Ä—É–≥–æ–≤. –ù–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–º –º–µ—Å—Ç–µ –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ 369 –∑–∞–≤–µ–¥–µ–Ω–∏–π –∏–ª–∏ 4,69% - –°–µ–≤–µ—Ä–æ-–ó–∞–≤–∞–¥–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥. 

# In[42]:


district_centr = df[df['district'] == '–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π –æ–∫—Ä—É–≥']
district_value_category = district_centr['category'].value_counts()
display(district_value_category)


# In[43]:


district_value_procent = district_centr['category'].value_counts(normalize=True)
display(round(district_value_procent*100, 2))


# In[44]:


graf_2 = district_value_category.plot(kind='barh', figsize=(12, 6), color='skyblue', edgecolor='black')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ')
plt.xlabel('–ö–∞—Ç–µ–≥–æ—Ä–∏–∏')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.grid(axis='x', alpha=0.7)
plt.show()


# –ü–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å–æ –≤—Å–µ–º–∏ –æ–∫—Ä—É–≥–∞–º–∏ –≥–¥–µ –ø—Ä–µ–æ–±–ª–∞–¥–∞–ª–∏ –∫–∞—Ñ–µ, –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤  - 665, —á—Ç–æ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 30%. 
# 
# –ü–æ 20% —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –∫–æ—Ñ–µ–π–Ω–∏ –∏ –∫–∞—Ñ–µ. –ü–∞–±–æ–≤ –∏ –±–∞—Ä–æ–≤ - 16% –∏–ª–∏ 364, –ø–æ –≤—Å–µ–º –æ–∫—Ä—É–≥–∞–º –±—ã–ª–æ –≤—Å–µ–≥–æ 9%. 
# 
# –ë—É–ª–æ—á–Ω—ã–µ, –∫–∞–∫ –∏ –Ω–∞ –æ–±—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –º–µ–Ω—å—à—É—é —á–∞—Å—Ç—å –≤ –¶–ê–û - 2,26% –∏–ª–∏ 50 –∑–∞–≤–µ–¥–µ–Ω–∏–π.
# 

# ---
# 
# ### –ó–∞–¥–∞—á–∞ 3
# 
# –ò–∑—É—á–∏—Ç–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤ —Ü–µ–ª–æ–º –ø–æ –≤—Å–µ–º –¥–∞–Ω–Ω—ã–º –∏ –≤ —Ä–∞–∑—Ä–µ–∑–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∑–∞–≤–µ–¥–µ–Ω–∏—è. –ö–∞–∫–∏—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –±–æ–ª—å—à–µ ‚Äî —Å–µ—Ç–µ–≤—ã—Ö –∏–ª–∏ –Ω–µ—Å–µ—Ç–µ–≤—ã—Ö? –ö–∞–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π —á–∞—â–µ —è–≤–ª—è—é—Ç—Å—è —Å–µ—Ç–µ–≤—ã–º–∏? –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ, –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –∏ –ø–æ—Å—Ç—Ä–æ–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏.

# In[45]:


chain_count = df['chain'].value_counts()


# In[46]:


display(chain_count)


# In[47]:


chain_procent = df['chain'].value_counts(normalize=True)


# In[48]:


chain_procent.plot(kind='bar', rot=0, legend=True, figsize=(12, 6), edgecolor='black')
plt.grid(axis='y', alpha=0.3)
plt.title('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ç–µ–≤—ã—Ö/–Ω–µ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π')
plt.xlabel('–¢–∏–ø –∑–∞–≤–µ–¥–µ–Ω–∏—è: 1 - —Å–µ—Ç–µ–≤–æ–µ –∑–∞–≤–µ–¥–µ–Ω–∏–µ, 0 - –Ω–µ —Å–µ—Ç–µ–≤–æ–µ')
plt.ylabel('–î–æ–ª—è –∑–∞–≤–µ–¥–µ–Ω–∏–π')
plt.show()


# –ù–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π - 5199, —Å –¥–æ–ª–µ–π 61%. –°–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π - 3203, —Å –¥–æ–ª–µ–π 39%.

# In[49]:


chain_grouped = df.groupby('category')['chain'].value_counts(normalize=True).unstack(fill_value=0)
display(chain_grouped)


# In[50]:


chain_set = round(chain_grouped[1], 2)
chain_set_sort = chain_set.sort_values(ascending=False)


# In[51]:


chain_set_sort.plot(kind='bar', legend=True, rot=45, figsize=(12, 8), edgecolor='black')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º')
plt.grid(axis='y', alpha=0.3)
plt.xlabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.show()


# –ù–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π - 5199, —Å –¥–æ–ª–µ–π 61%. –°–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π - 3203, —Å –¥–æ–ª–µ–π 39%.
# 
# –ë—É–ª–æ—á–Ω—ã—Ö –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π –º–∞–ª–æ, –Ω–æ –¥–æ–ª—è —Å–µ—Ç–µ–≤—ã—Ö –±—É–ª–æ—á–Ω—ã—Ö —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 61%.
# 
# –ü–∏—Ü—Ü–µ—Ä–∏—è –∏ –∫–æ—Ñ–µ–π–Ω–∏ –∏–º–µ—é—Ç –ø–æ 51% —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π.
# 
# –ë–∞—Ä—ã –∏ –ø–∞–±—ã —á–∞—â–µ –Ω–µ—Å–µ—Ç–µ–≤—ã–µ, –¥–æ–ª—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤—Å–µ–≥–æ 21%.

# ---
# 
# ### –ó–∞–¥–∞—á–∞ 4
# 
# –ò—Å—Å–ª–µ–¥—É–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –≤ –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö. –í—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è –ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–ª–∏ –≤—ã–±—Ä–æ—Å—ã? –ï—Å–ª–∏ –¥–∞, —Ç–æ —Å —á–µ–º –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã? –ü—Ä–∏–≤–µ–¥–∏—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π –Ω–∞–∏–±–æ–ª–µ–µ —Ç–∏–ø–∏—á–Ω–æ–µ –¥–ª—è –Ω–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è–º–∏.
# 

# In[52]:


df_seats = df[df['seats'] != -1]


# In[53]:


#seats_box = df_seats['seats'].plot(kind = 'box', vert=False, figsize=(12, 8))
import seaborn as sns
plt.figure(figsize=(12, 8))
sns.boxplot(data=df_seats, x = 'category', y = 'seats')
plt.title('–í—ã–±—Ä–æ—Å—ã seats')
plt.xlabel("–ö–∞—Ç–µ–≥–æ—Ä–∏–∏")
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç')
#plt.xlabel('')
plt.show()


# –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–º–µ–µ—é—Ç –≤—ã–±—Ä–æ—Å—ã, –æ—Å–æ–±–µ–Ω–æ –∑–∞–º–µ—Ç–Ω–æ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö: –∫–∞—Ñ–µ, —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã, –∫–æ—Ñ–µ–π–Ω–∏. –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —ç—Ç–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è –≤ —Å–ø–æ—Ä—Ç–∏–≤–Ω–æ-–∫–æ–Ω—Ü–µ—Ä—Ç–Ω—ã—Ö –∫–æ–ø–ª–µ–∫—Å–∞—Ö, —Ñ—É–¥-–∫–æ—Ä—Ç—ã –≤ –¢–¶, –∞—ç—Ä–æ–ø–æ—Ä—Ç—ã, –≤–æ–∫–∑–∞–ª—ã.

# In[54]:


df_seats_category_median = df_seats.groupby('category')['seats'].median()
display(df_seats_category_median)


# –†–µ—Å—Ç–æ—Ä–∞–Ω—ã, –ø–∞–±—ã, —Å—Ç–æ–ª–æ–≤—ã–µ —Å–∞–º—ã–µ –≤–º–µ—Å—Ç–∏—Ç–µ–ª—å–Ω—ã–µ, —á—Ç–æ –∏–º –∏ —Å–≤–æ–π—Å—Ç–≤–µ–Ω–Ω–æ. –ö–æ—Ñ–µ–π–Ω–∏ —Ç–æ–∂–µ –∏–º–µ—é—Ç –±–æ–ª—å—à—É—é –≤–º–µ—Å—Ç–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å—É–¥—è –ø–æ –¥–∞–Ω–Ω—ã–º, –Ω–æ —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ —ç—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ç–µ–º —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–æ—Ñ–µ–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¢–¶, –∞—ç—Ä–æ–ø—Ä—Ç–∞—Ö, –≤–æ–∫–∑–∞–ª–∞—Ö –≥–¥–µ –º–Ω–æ–≥ –æ–ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç. 
# –£ –ø–∏—Ü—Ü–µ—Ä–∏–π –æ–±—ã—á–Ω–æ –∞–∫—Ü–µ–Ω—Ç —Å–¥–µ–ª–∞–Ω –Ω–∞ –¥–æ—Å—Ç–∞–≤–∫—É, –ø–æ—ç—Ç–æ–º—É –ø–æ—Å–∞–¥–æ—á–Ω—ã—Ö –º–µ—Å—Ç –º–∞–ª–æ.

# ---
# 
# ### –ó–∞–¥–∞—á–∞ 5
# 
# –ò—Å—Å–ª–µ–¥—É–π—Ç–µ —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–≤–µ–¥–µ–Ω–∏–π. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–∏—Ö —Ä–µ–π—Ç–∏–Ω–≥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∑–∞–≤–µ–¥–µ–Ω–∏–π. –°–∏–ª—å–Ω–æ –ª–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –æ–±—â–µ–ø–∏—Ç–∞?

# In[55]:


display(df['rating'].describe())


# –ü–æ–ª–æ–≤–∏–Ω–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º 4,3 - –∏–º–µ–µ—é—Ç –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ. 25% –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º 4,4 - –≤—ã—à–µ –∫–∞—á–µ—Å—Ç–≤–æ —É—Å–ª—É–≥ –∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤.
# 
# –ù–æ—Ä–º–∞ —É –≤—Å–µ—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –≤—ã—à–µ 4.

# In[56]:


rating_stat = df.groupby('category')['rating'].describe()
display(rating_stat)


# In[57]:


rating_category = df.groupby('category')['rating'].mean()
rating_sort = rating_category.sort_values(ascending=True)


# In[58]:


#display(round(rating_sort, 2))


# In[59]:


graf_3 = rating_sort.plot(kind='barh', figsize=(10, 6), color='skyblue', edgecolor='black')
plt.grid(axis='x', alpha=0.6)
plt.xlim(4.0, 5.0)
plt.xticks([4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5.0])
plt.title('–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º')
plt.xlabel('–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.show()


# –õ–∏–¥–µ—Ä –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É –±–∞—Ä—ã –∏ –ø–∞–±—ã - 4,39. –£ —Ä–µ—Å—Ç–æ—Ä–∞–Ω–æ–≤ –Ω–µ–º–Ω–æ–≥–æ –Ω–∏–∂–µ 4,29. –ü–∏—Ü–µ—Ä–∏–∏ 4.30.
# 
# –£ –ø–∏—Ü—Ü–µ—Ä–∏–π —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π std, —á—Ç–æ –º–æ–∂–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å –æ–± —Å—Ç–∞–±–∏–ª—å–Ω–æ–º –∫–∞—á–µ—Å—Ç–≤–µ —É—Å–ª—É–≥ –∏ –±–ª—é–¥ –≤–æ –≤—Å–µ—Ö –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö.
# 
# –°–∞–º—ã–π –Ω–∏–∑–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —É –±—ã—Å—Ç—Ä–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è - –±—ã—Å—Ç—Ä–æ–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å, –Ω–µ—Ç –∞–∫—Ü–µ–Ω—Ç–∞ –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ –±–ª—é–¥.
# 
# –£ –∫–∞—Ñ–µ –±–æ–ª—å—à–æ–π std, —á—Ç–æ –≥–æ–≤—Ä–∏—Ç –æ–± –±–æ–ª—å—à–æ–π —Ä–∞–∑–Ω–æ—Å—Ç–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞. –Ω–æ –≤—Å–µ —Ä–∞–≤–Ω–æ 75% –∑–∞–≤–µ–¥–µ–Ω–∏–π —Å —Ä–µ–π—Ç–∏–Ω–≥–æ–º 4 –∏ –≤—ã—à–µ. 

# <font color='DarkBlue'><b>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞</b></font><br>
# <font color='DarkGreen'>üëå –•–æ—Ä–æ—à–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç–æ–ª–±—á–∞—Ç–æ–π –¥–∏–∞–≥—Ä–∞–º–º–æ–π —Ä–µ–π—Ç–∏–Ω–≥–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.</font>

# ---
# 
# ### –ó–∞–¥–∞—á–∞ 6
# 
# –ò–∑—É—á–∏—Ç–µ, —Å –∫–∞–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–∞–º—É—é —Å–∏–ª—å–Ω—É—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Ä–µ–π—Ç–∏–Ω–≥–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π? –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –º–∞—Ç—Ä–∏—Ü—É –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞ –∑–∞–≤–µ–¥–µ–Ω–∏—è —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏: –µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è, –ø–æ–ª–æ–∂–µ–Ω–∏–µ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞–π–æ–Ω –ú–æ—Å–∫–≤—ã), —Å—Ç–∞—Ç—É—Å —Å–µ—Ç–µ–≤–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏—è, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Å—Ç, —Ü–µ–Ω–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –∏ –ø—Ä–∏–∑–Ω–∞–∫, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –∑–∞–≤–µ–¥–µ–Ω–∏—è –∫—Ä—É–≥–ª–æ—Å—É—Ç–æ—á–Ω—ã–º. –í—ã–±–µ—Ä–∏—Ç–µ —Å–∞–º—É—é —Å–∏–ª—å–Ω—É—é —Å–≤—è–∑—å –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –µ—ë.

# In[60]:


df_copy = df.copy()


# In[61]:


import numpy as np


# In[62]:


df_copy['seats'] = df_copy['seats'].replace(-1, np.nan)
#df_copy['hours'] = df_copy['hours'].replace('–ß–∞—Å—ã —Ä–∞–±–æ—Ç—ã –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã', np.nan)


# In[63]:


correlation_matrix = df_copy[['rating', 'category','district', 'chain', 'seats', 'price', 'is_24_7']].phik_matrix()

print('–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º phi_k –¥–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π rating')
#correlation_matrix.loc[correlation_matrix.index != 'rating'][['rating']].sort_values(by='rating', ascending=False)
rating_corr = correlation_matrix['rating'].drop('rating').sort_values(ascending=False)
display(rating_corr)


# In[64]:


# –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —Ä–µ–≤—å—é–µ—Ä–∞
df['seats'].value_counts().head(2)


# In[65]:


plt.figure(figsize=(3, 6))
data_heatmap = pd.DataFrame(rating_corr)

sns.heatmap(data=data_heatmap, annot=True, fmt='.2f', cmap='coolwarm', linewidths=0.5, cbar=False)
plt.title('–¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ phi_k \n –¥–ª—è –¥–∞–Ω–Ω—ã—Ö rating')
plt.ylabel('')
plt.tight_layout()
plt.show()


# –ù–∞–∏–±–æ–ª—å—à–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è rating —Å–≤—è–∑–∞–Ω–∞ —Å —Ü–µ–Ω–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π - `price`(0.22) –∏ –≤—Ç–æ—Ä–æ–µ –º–µ—Å—Ç–æ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π –∑–∞–≤–µ–¥–µ–Ω–∏—è - `district`(0.20). 0 –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è rating –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–µ—Å—Ç `seats`, –≤–æ–æ–±—â–µ –Ω–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Å–≤—è–∑–∏.

# In[66]:


price_rating_cor = df_copy.groupby('price')['rating'].describe()
display(price_rating_cor)


# In[67]:


plt.figure(figsize=(8, 6))
sns.boxplot(data=df_copy, x='price', y='rating')
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ü–µ–Ω—ã')
plt.xlabel('–¶–µ–Ω–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.ylabel('–†–µ–π—Ç–∏–Ω–≥')
plt.grid(axis='y', alpha=0.3)
plt.tight_layout()
plt.show()


# –£ "–í—ã—Å–æ–∫–∏–µ" - —Å—Ç–∞–±–∏–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ, —Ä–µ–π—Ç–∏–Ω–≥ 4.44, std 0.31, 25% –∑–∞–≤–µ–¥–µ–Ω–∏–π –∏–º–µ—é—Ç —Ä–µ–π—Ç–∏–Ω–≥ –≤—ã—à–µ 4.6 - –æ—Ç–ª–∏—á–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–∏—Å–∞, –±–ª—é–¥ –∏ –ø–æ–º–µ—â–µ–Ω–∏–π.
# 
# –£ –Ω–∏–∑–∫–∏—Ö —Ü–µ–Ω —Å–∞–º—ã–π –Ω–∏–∑–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∏ –±–æ–ª—å—à–π–æ —Ä–∞–∑–±—Ä–æ—Å, —á—Ç–æ –≤–∏–¥–Ω–æ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ –∏ std 0.373.

# ---
# 
# ### –ó–∞–¥–∞—á–∞ 7
# 
# –°–≥—Ä—É–ø–ø–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—è–º –∑–∞–≤–µ–¥–µ–Ω–∏–π –∏ –Ω–∞–π–¥–∏—Ç–µ —Ç–æ–ø-15 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–µ—Ç–µ–π –≤ –ú–æ—Å–∫–≤–µ. –î–ª—è –Ω–∏—Ö –ø–æ—Å—á–∏—Ç–∞–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞. –ü–æ–¥ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—å—é –ø–æ–Ω–∏–º–∞–µ—Ç—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π —ç—Ç–æ–π —Å–µ—Ç–∏ –≤ —Ä–µ–≥–∏–æ–Ω–µ. –ö –∫–∞–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–≤–µ–¥–µ–Ω–∏–π –æ–Ω–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è? –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è–º–∏.

# In[68]:


df_set = df[df['chain'] == 1]


# In[69]:


top15 = df_set.groupby('name').agg(count=('name', 'size'), rating=('rating', 'mean'), category=('category', 'first')).reset_index()
top15['rating'] = round(top15['rating'], 2)


# In[70]:


top15 = top15.sort_values(by='count', ascending=False).head(15)


# In[71]:


print('–¢–æ–ø 15 –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π –ú–æ—Å–∫–≤—ã:')
display(top15)


# In[72]:


top15 = top15.sort_values(by='count', ascending=True).head(15)


# In[73]:


name_count = top15.plot(kind='barh', x='name', y='count', color='skyblue', 
    edgecolor='black', figsize=(12, 6), legend=False)
plt.title('–¢–æ–ø 15 —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π ')
plt.xlabel('–ù–∞–∑–≤–∞–Ω–∏–µ')
plt.ylabel('–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ')
plt.show()


# In[74]:


top15_rating = top15.sort_values(by='rating', ascending=True)


# In[75]:


name_count = top15_rating.plot(kind='barh', x='name', y='rating', color='skyblue', 
    edgecolor='black', figsize=(10, 6), legend=False)
plt.title('–¢–æ–ø 15 —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π ')
plt.xlim(3.5, 5.0)
plt.xticks([3.5, 3.6, 3.7, 3.8, 3.9, 4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5.0])
plt.title('–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º')
plt.xlabel('–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥')
plt.ylabel('–ö–∞—Ç–µ–≥–æ—Ä–∏—è')
plt.xlabel('–ù–∞–∑–≤–∞–Ω–∏–µ')
plt.ylabel('–†–µ–π—Ç–∏–Ω–≥')
plt.show()


# "–®–æ–∫–æ–ª–∞–¥–Ω–∏—Ü–∞" –ª–∏–¥–µ—Ä –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∑–∞–≤–µ–¥–µ–Ω–∏–π -120—à—Ç –∏ —Ö–æ—Ä–æ—à–∏–π —Ä–µ–π—Ç–∏–Ω–≥ 4.18, –∫–∞—Ç–µ–≥–æ—Ä–∏—è - –∫–æ—Ñ–µ–π–Ω—è.
# 
# –í —Ç–æ–ø 3 –≤—Ö–æ–¥—è—Ç –¥–≤–µ –ø–∏—Ü—Ü–µ—Ä–∏–∏ –î–æ–º–∏–Ω–æ—Å —Å 77 –∑–∞–≤–µ–¥–µ–Ω–∏—è–º–∏ –∏ "–î–æ–¥–æ –ø–∏—Ü—Ü–∞" —Å 74. –ù–æ —É –î–æ–¥–æ –ø–∏—Ü—Ü–∞ –≤—ã—à–µ —Ä–µ–π—Ç–∏–Ω–≥ 4.29 –ø—Ä–æ—Ç–∏–≤ 4.17, –∞ —ç—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Å–µ–π —Å–µ—Ç–∏. 
# 
# –°–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —É "–±—É—Ö–∞–Ω–∫–∞" 4.4 —Å 32 –∑–∞–≤–µ–¥–µ–Ω–∏—è–º–∏, –∫–∞—Ç–µ–≥–æ—Ä–∏—è –±—É–ª–æ—á–Ω–∞—è. –ò —É "–∫—É–ª–∏–Ω–∞—Ä–Ω–∞—è –ª–∞–≤–∫–∞ –±—Ä–∞—Ç—å–µ–≤ –∫–∞—Ä–∞–≤–∞–µ–≤—ã—Ö" —Ä–µ–π—Ç–∏–Ω–≥ 4.39 —Å 39 –∑–∞–≤–µ–¥–µ–Ω–∏—è–º–∏ - —á—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –≤ –ø–æ–≥–æ–Ω–µ –∑–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å—é –∫–∞–∫ —É "–®–æ–∫–æ–ª–∞–¥–Ω–∏—Ü–∞" –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–±—ã–≤–∞—Ç—å –æ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–≤–µ–¥–µ–Ω–∏–π.

# ---
# 
# ### –ó–∞–¥–∞—á–∞ 8
# 
# –ò–∑—É—á–∏—Ç–µ –≤–∞—Ä–∏–∞—Ü–∏—é —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –∑–∞–≤–µ–¥–µ–Ω–∏—è (—Å—Ç–æ–ª–±–µ—Ü `middle_avg_bill`) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–π–æ–Ω–∞ –ú–æ—Å–∫–≤—ã. –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ü–µ–Ω—ã –≤ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –æ–∫—Ä—É–≥–µ –∏ –¥—Ä—É–≥–∏—Ö. –ö–∞–∫ —É–¥–∞–ª—ë–Ω–Ω–æ—Å—Ç—å –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ü–µ–Ω—ã –≤ –∑–∞–≤–µ–¥–µ–Ω–∏—è—Ö? –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–ø—Ä–æ–≤–æ–¥–∏—Ç–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è–º–∏.
# 

# In[76]:


temp2 = df['middle_avg_bill']


# In[77]:


gr1 = temp2.plot(kind='box', figsize=(12, 4), vert=False)
plt.grid(axis='x', alpha=0.4)
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞')
plt.xlabel('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫')
plt.show()


# In[78]:


gr2 = temp2.plot(kind='hist', figsize=(10, 5), bins=50)
plt.grid(axis='x', alpha=0.4)
plt.grid(axis='y', alpha=0.4)
plt.title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞')
plt.xlabel('–°—Ä–µ–¥–Ω–∏–π —á–µ–∫')
plt.ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
plt.show()


# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –±–µ–∑ —Ä–∞–∑–±–∏–≤–∫–∏ –ø–æ –æ–∫—Ä—É–≥–∞–º –ø–æ–∫–∞–∑–∞–ª, —á—Ç–æ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞ –¥–æ 2000 —Ä—É–±–ª–µ–π —Å –ø–∏–∫–æ–≤–æ–π —á–∞—Å—Ç–æ—Ç–æ–π 1450 –Ω–∞–±–ª—é–¥–µ–Ω–∏–π. 

# –ë–æ–ª—å—à–∏–Ω—Å–≤–æ —á–µ–∫–æ–≤ –Ω–µ –ø—Ä–µ–≤—ã—à–∞—é—Ç 5000 —Ä—É–±., —Å–∏–ª—å–Ω—ã–π –ø—Ä–∞–≤—ã–π —Å–∫–æ—Å –≤ –±–æ–∫—Å–µ - –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ–ª—å—à–∏—Ö —á–µ–∫–æ–≤ –≤ –¥–∏–∞–ø–æ–∑–æ–Ω–µ –¥–æ 35000 —Ä—É–±.

# In[79]:


district_price = df.groupby('district')['middle_avg_bill'].describe()[['mean', '50%']]


# In[80]:


display(district_price)


# ---
# 

# In[81]:


district_graf = district_price.plot(kind='barh', figsize=(12,8))
plt.title('–¶–µ–Ω–æ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ –∑–∞–≤–µ–¥–µ–Ω–∏–π –ú–æ—Å–∫–≤—ã')
plt.grid(axis='x', alpha=0.7)
plt.xlabel('–¶–µ–Ω—ã')
plt.ylabel('–û–∫—Ä—É–≥')
plt.show()


# –¶–ê–û –∏ –ó–ê–û - –≤—ã—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è: –º–µ–¥–∏–∞–Ω–∞ 1000 —Ä—É–±, —Å—Ä–µ–¥–Ω–µ–µ –±–æ–ª—å—à–µ 1000 —Ä—É–±. –≤ –¥–∞–Ω–Ω—ã—Ö –æ–∫—Ä—É–≥–∞—Ö –Ω–∞–±–ª—é–¥–∞—é—Ç—Å—è –≤—ã—Å–æ–∫–∏–µ —á–µ–∫–∏, –∑–Ω–∞—á–∏—Ç –≤—ã—Å–æ–∫–æ–µ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ –∏ –∫–∞—á–µ—Å—Ç–≤–æ –±–ª—é–¥. 
# 
# –Æ–í–ê–û - –Ω–∏–∑–∫–∏–µ —Ü–µ–Ω—ã: –º–µ–¥–∏–∞–Ω–∞ 450 —Ä—É–± - –±—é–¥–∂–µ—Ç–Ω—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è, –Ω–∏–∑–∫–∏–µ —Ü–µ–Ω—ã.
# 
# –†–∞–∑–Ω–∏—Ü–∞ –≤ –¶–ê–û –≤ 191 —Ä—É–± –º–µ–∂–¥—É —Å—Ä–µ–¥–Ω–∏–º –∏ –º–µ–¥–∏–∞–Ω–æ–π –≥–æ–≤–æ—Ä–∏—Ç –æ –≤—ã—Å–æ–∫–∏—Ö –≤—ã–±—Ä–æ—Å–∞—Ö, –µ—Å—Ç—å –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø—Ä–∏–º–∏—É–º –∫–ª–∞—Å—Å–∞ —Å –≤—ã—Å–æ–∫–∏–º —Å—Ä–µ–¥–Ω–∏–º —á–µ–∫–æ–º, –¥–æ—Ä–æ–≥–∏–µ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã, –∑–∞–≤–µ–¥–µ–Ω–∏—è –≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç–∞—Ö. 
# 
# 

# ---
# 
# ### –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –≤—ã–≤–æ–¥
# 
# 

# 
# **–ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø–∏—Ç–∞–Ω–∏—è –ú–æ—Å–∫–≤—ã –≤—ã—è–≤–∏–ª:**
# 
#    - **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ - –ª–∏–¥–µ—Ä—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É**: –∫–∞—Ñ–µ - 2002, —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã - 1968 –∏  –∫–æ—Ñ–µ–π–Ω–∏ - 1398.  
#    - **–°–∞–º–∞—è –º–∞–ª–µ–Ω—å–∫–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è**: –±—É–ª–æ—á–Ω—ã–µ - 249 –∏  —Å—Ç–æ–ª–æ–≤—ã–µ 230.  
#    - –∫–∞—Ñ–µ ‚Äî —Å–∞–º—ã–π –º–∞—Å—Å–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
# 
# 
#    - **–¶–ê–û** –∏–º–µ–µ—Ç 28% –≤—Å–µ—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π - 2211, –≤ –¶–ê–û —Ç–æ–ø –∫–∞—Ç–µ–≥–æ—Ä–∏—è -  —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã 30%.  
#    - **–Æ–í–ê–û** –∏–º–µ–µ—Ç –Ω–∞–∏–º–µ–Ω—å—à–∏–π –æ—Ö–≤–∞—Ç –≤—Å–µ–≥–æ 412 –∑–∞–≤–µ–¥–µ–Ω–∏–π.  
#    - –¶–ê–û –æ—Å–Ω–æ–≤–Ω–∞—è –∑–æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
#    
#    
#    - –ù–µ—Å–µ—Ç–µ–≤—ã—Ö –∑–∞–≤–µ–¥–µ–Ω–∏–π 61%, 39% —Å–µ—Ç–µ–≤—ã—Ö
#    - –°–µ—Ç–µ–≤—ã–µ –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö –∫–æ—Ñ–µ–π–Ω—è—Ö –∏ –ø–∏—Ü—Ü–µ—Ä–∏—è—Ö
#    - **–¢–æ–ø-3 –∑–∞–≤–µ–¥–µ–Ω–∏—è –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É:** "–®–æ–∫–æ–ª–∞–¥–Ω–∏—Ü–∞" 120, "–î–æ–º–∏–Ω–æ –ü–∏—Ü—Ü–∞" - 77, "–î–æ–¥–æ –ø–∏—Ü—Ü–∞" - 74
#    - **–í—ã—Å–æ–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞–≤–µ–¥–µ–Ω–∏–π** —É "–±—É—Ö–∞–Ω–∫–∞" 4.4 , "–∫—É–ª–∏–Ω–∞—Ä–Ω–∞—è –ª–∞–≤–∫–∞ –±—Ä–∞—Ç—å–µ–≤ –∫–∞—Ä–∞–≤–∞–µ–≤—ã—Ö" -4.39, "–î–æ–¥–æ –ü–∏—Ü—Ü–∞" - 4.29
#    - –ú–∞—Å—à—Ç–∞–±–Ω–æ—Å—Ç—å —Å–µ—Ç–∏ –Ω–µ –≤—Å–µ–≥–¥–∞ –≥–æ–≤–æ—Ä–∏—Ç –æ –µ–µ –∫–∞—á–µ—Å—Ç–≤–µ
#    
#   
#    - –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–º–µ–µ—é—Ç —Ä–µ–π—Ç–∏–Ω–≥ –±–æ–ª—å—à–µ 4.0  
#    - **–í—ã—Å–æ–∫–∏–π —Ä–µ–π—Ç–∏–Ω–≥ —É –∫–∞—Ç–µ–≥–æ—Ä–∏–π** –±–∞—Ä/–ø–∞–± - 4.39 –∏ –ø–∏—Ü—Ü–µ—Ä–∏—è –∏ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã –ø–æ 4.30.  
#    - **–ü–ª–æ—Ö–æ–π —Ä–µ–π—Ç–∏–Ω–≥ —É –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**: –±—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ - 4.06.  
#    - –§–æ—Ä–º–∞—Ç –∑–∞–≤–µ–¥–µ–Ω–∏—è –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–æ –∏ –æ—Ü–µ–Ω–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
#    
#    - –û–±—â–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ —á–µ–∫–∞: –º–Ω–æ–≥–æ —á–µ–∫–æ–≤ –Ω–∞ –¥–æ 2000 —Ä—É–±., 75% —á–µ–∫–æ–≤ –¥–æ 5000 —Ä—É–±., –≤—ã–±—Ä–æ—Å—ã –¥–æ 35 000 —Ä—É–±.
# 
# 
#    - –ù–∞–∏–±–æ–ª—å—à–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è rating —Å–≤—è–∑–∞–Ω–∞ —Å —Ü–µ–Ω–æ–≤–æ–π –ø–æ–ª–∏—Ç–∏–∫–æ–π - price(0.22) –∏ –≤—Ç–æ—Ä–æ–µ –º–µ—Å—Ç–æ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π –∑–∞–≤–µ–¥–µ–Ω–∏—è -   district(0.20). 
#    - 0 –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è rating –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–µ—Å—Ç seats, –≤–æ–æ–±—â–µ –Ω–µ—Ç –Ω–∏–∫–∞–∫–æ–π —Å–≤—è–∑–∏.
#   
#    - **–¶–ê–û –∏ –ó–ê–û** –∏–º–µ—é—Ç –º–µ–¥–∏–∞–Ω—É 1000 —Ä—É–±, —Å—Ä–µ–¥–Ω–µ–µ –±–æ–ª—å—à–µ 1100 —Ä—É–± - –º–Ω–æ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤—ã—Å–æ–∫–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞.  
#    - **–Æ–í–ê–û** - –±—é–¥–∂–µ—Ç–Ω—ã–π —Å–µ–≥–º–µ–Ω—Ç.  
#    - –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≤–µ–¥–µ–Ω–∏–π –≤–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–∞–π–æ–Ω–∞ —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç —Ü–µ–Ω–æ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É.
# 

# ## 4. –ò—Ç–æ–≥–æ–≤—ã–π –≤—ã–≤–æ–¥ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
# 
# 
# #### –¶–µ–ª—å –∏ –∑–∞–¥–∞—á–∏ –ø—Ä–æ–µ–∫—Ç–∞
# –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ –æ–±—â–µ–ø–∏—Ç–∞ –ú–æ—Å–∫–≤—ã (–ª–µ—Ç–æ 2022) –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –Ø–Ω–¥–µ–∫—Å.–ö–∞—Ä—Ç –∏ –Ø–Ω–¥–µ–∫—Å.–ë–∏–∑–Ω–µ—Å.  
# **–¶–µ–ª—å**: –ø–æ–º–æ—á—å –∏–Ω–≤–µ—Å—Ç–æ—Ä–∞–º —Ñ–æ–Ω–¥–∞ **"Shut Up and Take My Money"** –≤—ã–±—Ä–∞—Ç—å **–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –∏ –ª–æ–∫–∞—Ü–∏—é** –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è **–∫–∞—Ñ–µ, —Ä–µ—Å—Ç–æ—Ä–∞–Ω–∞ –∏–ª–∏ –±–∞—Ä–∞**.
# 
# ---
# 
# #### –ü–æ–∫–∞–∑–∞—Ç–µ–ª–∏
# 
# 
# **–í—Å–µ–≥–æ –∑–∞–≤–µ–¥–µ–Ω–∏–π**  8406 
# 
# **–õ–∏–¥–µ—Ä—ã –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É** –∫–∞—Ñ–µ -2002, —Ä–µ—Å—Ç–æ—Ä–∞–Ω—ã - 1968
# 
# **–õ–∏–¥–µ—Ä –ø–æ –¥–æ–ª–µ** –¶–ê–û - 28% –∏–ª–∏ 2211
# 
# **–°–µ—Ç–µ–≤—ã–µ** 39% –∏–ª–∏ 3087, –ø–æ–ø—É–ª—è—Ä–Ω—ã –∫–æ—Ñ–µ–π–Ω–∏ –∏ –ø–∏—Ü—Ü–µ—Ä–∏–∏ 
# 
# **–¢–æ–ø –ø–æ —Ä–µ–π—Ç–∏–Ω–≥—É** —É "–∫—É–ª–∏–Ω–∞—Ä–Ω–∞—è –ª–∞–≤–∫–∞ –±—Ä–∞—Ç—å–µ–≤ –∫–∞—Ä–∞–≤–∞–µ–≤—ã—Ö" - 4.39, "–î–æ–¥–æ –ü–∏—Ü—Ü–∞" - 4.29
# 
# **–°—Ä–µ–¥–Ω–∏–π —á–µ–∫** –¶–ê–û - 1000 —Ä—É–±, –Æ–í–ê–û - 450 —Ä—É–±
# 
# 
# 
# #### –≤—ã–≤–æ–¥—ã –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
# 
# **–ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞**  –û–±—ä–µ–¥–∏–ª –¥–∞–Ω–Ω—ã–µ, –æ–±—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–æ–ø—É—Å–∫–∏, –ø–æ–ª–Ω—ã–µ –¥—É–±–ª–∏–∫–∞—Ç—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç
# 
# **–ö–∞—Ç–µ–≥–æ—Ä–∏–∏**  –ö–∞—Ñ–µ - –º–∞—Å—Å–æ–≤—ã–π —Å–µ–≥–º–µ–Ω—Ç
# 
# **–†–∞–π–æ–Ω—ã** –¶–ê–û - —Ü–µ–Ω—Ç—Ä —Å–ø—Ä–æ—Å–∞ –∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, –Æ–í–ê–û - –º–∞–ª–µ–Ω—å–∫–∏–π —Å–ø—Ä–æ—Å 
# 
# **–°–µ—Ç–∏**  –ú–∞—Å—à—Ç–∞–± –Ω–µ –ø–æ–≤—ã—à–∞–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥
# 
# **–†–µ–π—Ç–∏–Ω–≥**  –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ü–µ–Ω –∏ —Ä–∞–π–æ–Ω–∞, –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ—Å—Ç
# 
# **–°—Ä–µ–¥–Ω–∏–π —á–µ–∫** –¶–ê–û –∏ –ó–ê–û - –≤—ã—Å–æ–∫–∏–π, –Æ–í–ê–û - –Ω–∏–∑–∫–∏–π
# 
# ---
# 
# #### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
# 
# 
# –ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –æ—Ç–∫—Ä—ã—Ç—å **–ö–æ—Ñ–µ–π–Ω—é** –≤ **–¶–ê–û** —Ü–µ–Ω–æ–≤–æ–π —Å–µ–≥–º–µ–Ω—Ç 900‚Äì1200 —Ä—É–± - –≤—ã—Å–æ–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫, –¥–µ–Ω–µ–∂–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è, –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –≤—ã—Å–æ–∫–æ–≥–æ —Ä–µ–π—Ç–∏–Ω–≥–∞
# 
# –ï—Å–ª–∏ **–†–µ—Å—Ç–æ—Ä–∞–Ω** –∏–ª–∏ **–ë–∞—Ä** –≤ **–¶–ê–û** –∏–ª–∏ **–ó–ê–û** —á–µ–∫ –≤—ã—à–µ 1200 —Ä—É–± - –≤—ã—Å–æ–∫–∏–π —Ç—Ä–∞—Ñ–∏–∫,  –≤—ã—Å–æ–∫–∏–π —á–µ–∫, –¥–µ–Ω–µ–∂–Ω–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è
# 
# –ï—Å–ª–∏ **–ü–∏—Ü—Ü–µ—Ä–∏—è** –≤ **–í–ê–û, –Æ–ê–û, –°–í–ê–û** —Å —á–µ–æ–∫–º 600‚Äì800 —Ä—É–± - –æ—Ä–∏–µ–Ω—Ç–∏—Ä –Ω–∞ —Å–µ—Ç—å, –ø—Ä–æ—Ñ–µ—Ä–µ–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç, –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å
# 
# –ù–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –æ–∫—Ä—É–≥ **–Æ–í–ê–û** - –ù–∏–∑–∫–∏–π —á–µ–∫, –Ω–∏–∑–∫–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è
# 
# –ù–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–∏  **–ë—É–ª–æ—á–Ω—ã–µ** –∏ **—Å—Ç–æ–ª–æ–≤—ã–µ** - –Ω–∏–∑–∫–∏–π —Å–ø—Ä–æ—Å
# 
# –ë—ã—Å—Ç—Ä–æ–µ **–ë—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ** –∏–º–µ–µ—Ç –Ω–∏–∑–∫–∏–π –æ–±—â–∏–π —Ä–µ–π—Ç–∏–Ω–≥ - 4.06, –µ—Å–ª–∏ –ø—Ä–µ—É—Å–ø–µ—Ç—å –∏ –ø–æ–≤—ã—Å–∏—Ç—å —Ä–µ–π—Ç–∏–Ω–≥, —Ç–∞–∫–æ–µ –±—ã—Å—Ç—Ä–æ–µ –ø–∏—Ç–∞–Ω–∏–µ —Å–º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–º. 
